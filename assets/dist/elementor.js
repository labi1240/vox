!function(e){"function"==typeof define&&define.amd?define("elementor",e):e()}(function(){"use strict";elementor.modules.controls.Voxel_Post_Select=elementor.modules.controls.BaseData.extend({onReady(){let t=this.model.attributes.post_type,l=this.$el.find("input");var e=this.$el.find(".clear-value");let a=this.$el.find(".search-results"),s=this.$el.find(".value-wrap"),i=this.$el.find(".current-value"),o=i.attr("href");var n,r=this.getControlValue();r&&(n=VX_Post_Select_Cache[r]?`<span>: ${VX_Post_Select_Cache[r]}</span>`:"",i.html(`<b>#${r}</b>`+n),i.attr("href",o.replace(":id",r)),s.show()),l.on("input",Voxel_Backend.helpers.debounce(e=>{e=e.currentTarget.value.trim();e.length?(a.addClass("vx-disabled"),jQuery.get(Voxel_Config.ajax_url,{action:"general.search_posts",search:e,post_types:t.join(",")}).always(e=>{if(a.removeClass("vx-disabled hide"),e.success&&e.results.length){let t=[];e.results.forEach(e=>{t.push(`
						<div class="search-result">
							<a href="#" data-id="${e.id}">
								<b>#${e.id}: </b>
								<span>${e.title}</span>
							</a>
						</div>`)}),a.html(t.join(""))}else a.html("<p>No results found.</p>")})):a.addClass("hide")})),a.on("click","a",e=>{e.preventDefault();var t=e.currentTarget.dataset.id,e=e.currentTarget.querySelector("span").innerText;this.setValue(t),this.applySavedValue(),i.html(`<b>#${t}</b><span>: ${e}</span>`),i.attr("href",o.replace(":id",t)),s.show(),l.val(""),a.addClass("hide"),VX_Post_Select_Cache[t]=e}),e.on("click",e=>{e.preventDefault(),console.log(s),this.setValue(""),this.applySavedValue(),s.hide()})}}),elementor.modules.controls.Voxel_Term_Select=elementor.modules.controls.BaseData.extend({onReady(){let t=this.model.attributes.taxonomy,l=this.$el.find("input");var e=this.$el.find(".clear-value");let a=this.$el.find(".search-results"),s=this.$el.find(".value-wrap"),i=this.$el.find(".current-value"),o=i.attr("href");var n,r=this.getControlValue();r&&(n=VX_Term_Select_Cache[r]?`<span>: ${VX_Term_Select_Cache[r]}</span>`:"",i.html(`<b>#${r}</b>`+n),i.attr("href",o.replace(":id",r)),s.show()),l.on("input",Voxel_Backend.helpers.debounce(e=>{e=e.currentTarget.value.trim();e.length?(a.addClass("vx-disabled"),jQuery.get(Voxel_Config.ajax_url,{action:"general.search_terms",search:e,taxonomy:t.join(",")}).always(e=>{if(a.removeClass("vx-disabled hide"),e.success&&e.results.length){let t=[];e.results.forEach(e=>{t.push(`
						<div class="search-result">
							<a href="#" data-id="${e.id}">
								<b>#${e.id}: </b>
								<span>${e.title}</span>
							</a>
						</div>`)}),a.html(t.join(""))}else a.html("<p>No results found.</p>")})):a.addClass("hide")})),a.on("click","a",e=>{e.preventDefault();var t=e.currentTarget.dataset.id,e=e.currentTarget.querySelector("span").innerText;this.setValue(t),this.applySavedValue(),i.html(`<b>#${t}</b><span>: ${e}</span>`),i.attr("href",o.replace(":id",t)),s.show(),l.val(""),a.addClass("hide"),VX_Term_Select_Cache[t]=e}),e.on("click",e=>{e.preventDefault(),console.log(s),this.setValue(""),this.applySavedValue(),s.hide()})}}),elementor.addControlView("voxel-relation",elementor.modules.controls.BaseData.extend({onReady(){var i=this.model.get("vx_target"),o=this.model.get("vx_group"),n="right"===this.model.get("vx_side")?"right":"left",r="right"==n?"left":"right",e=elementor.$previewContents.find(".elementor-widget."+i),d=this.$el.find(".vx-relation-list"),t=i.replace("elementor-widget-",""),c=Vue.capitalize(Vue.camelize(t.replace("ts-",""))),h=this.options.container.id;elementor.config.voxel.relations[o]||(elementor.config.voxel.relations[o]=[]),e.each((e,t)=>{var l,a,s;t.parentElement.closest("."+i)||(l=t.dataset.id,a=!!elementor.config.voxel.relations[o].find(e=>e[n]===h&&e[r]===l),(s=$(`
				<div class="relation-item ${a?"selected":""}">
					<span>&lt;${c} <code>#${l}</code>&gt;</span>
					<i class="las la-eye view-icon"></i>
					<i class="las la-check check-icon"></i>
				</div>
			`)).on("mouseenter",()=>t.classList.add("voxel-highlight-element")),s.on("mouseleave",()=>t.classList.remove("voxel-highlight-element")),s.on("click",".view-icon",e=>{e.stopPropagation(),Voxel_Backend.helpers.isAnyPartOfElementInViewport(t)||t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}),s.on("click",()=>{s.toggleClass("selected").siblings().removeClass("selected"),this.setValue(null),elementor.config.voxel.relations[o]=elementor.config.voxel.relations[o].filter(e=>e[n]!==h),s.hasClass("selected")&&(elementor.config.voxel.relations[o]=elementor.config.voxel.relations[o].filter(e=>e[r]!==l),elementor.config.voxel.relations[o].push({left:"left"==n?h:l,right:"left"==n?l:h})),d.addClass("vx-disabled"),jQuery.post(Voxel_Config.ajax_url,{action:"elementor.save_temporary_config",document_id:elementor.config.document.id,voxel:JSON.stringify(window.voxel_prepare_page_settings())}).always(e=>{d.removeClass("vx-disabled")})}),d.append(s))}),d.find(".relation-item").length||d.html(`<div class="relation-item">No &lt;${c}&gt; widgets found.</div>`)}})),elementor.addControlView("voxel-visibility",elementor.modules.controls.BaseData.extend({onReady(){this._updatePreview(),this.$el.find(".vx-rules-edit").on("click",()=>{DTags.editVisibility(this.getControlValue(),e=>{this.setValue(e.length?e:""),this.applySavedValue(),this._updatePreview()})}),this.$el.find(".vx-rules-remove").on("click",()=>{this.setValue(""),this.applySavedValue(),this._updatePreview()})},_updatePreview(){var e=this.getControlValue();this.$el.find(".vx-visibility-rules").html(DTags.formatRulesAsHTML(e))}})),elementor.addControlView("voxel-loop",elementor.modules.controls.BaseData.extend({onReady(){this._updatePreview(),this.$el.find(".vx-loop-edit").on("click",()=>{DTags.useLoopItem(this.getControlValue(),e=>{this.setValue("string"==typeof e?e:""),this.applySavedValue(),this._updatePreview()})}),this.$el.find(".vx-loop-remove").on("click",()=>{this.setValue(""),this.applySavedValue(),this._updatePreview()})},_updatePreview(){let e='<span class="elementor-control-field-description">No loop</span>\t';var t,l=this.getControlValue(),l=DTags.parseTag(l);l&&l.path.length===l.raw_path.length&&(t=l.path.map(e=>e.label).join(" > "),e=`<span class="vx-loop-path">${l.group.title} > ${t}</span>`),this.$el.find(".vx-current-loop").html(e)}}));var a={text:"BaseData",textarea:"BaseData",number:"Number",wysiwyg:"Wysiwyg",date_time:"Date_time",url:"Url",media:"Media",gallery:"Gallery",icons:"Icons",code:"Code","voxel-post-select":"Voxel_Post_Select","voxel-term-select":"Voxel_Term_Select"};Object.keys(a).forEach(e=>{var t,l=elementor.modules.controls[a[e]];l?(t={onReady:l.prototype.onReady||(()=>{}),onBeforeDestroy:l.prototype.onBeforeDestroy||(()=>{})},elementor.addControlView(e,l.extend({onReady(){t.onReady.call(this),this.$el.prepend('<a href="#" class="enable-tags"><span>Enable Voxel tags</span></a>'),this.$el.find(".elementor-control-input-wrapper").first().before(`
				<div class="edit-voxel-tags" style="display: none;">
					<div class="tags-content"></div>
					<div class="dbuttons">
						<a href="#" class="edit-tags">Edit tags</a>
						<a href="#" class="disable-tags">Disable tags</a>
					</div>
				</div>
			`),DTags.isDynamicString(this._getDynamicValue())&&this._enableTags(),this.$el.on("click",".enable-tags",()=>{this._enableTags(),this._editTags()}),this.$el.on("click",".edit-tags",this._editTags.bind(this)),this.$el.on("click",".disable-tags",this._disableTags.bind(this))},onBeforeDestroy(){t.onBeforeDestroy.call(this),this.$el.off("click",".enable-tags",this._enableTags.bind(this)),this.$el.off("click",".edit-tags",this._editTags.bind(this)),this.$el.off("click",".disable-tags",this._disableTags.bind(this))},_getDynamicValue(){return this.getControlValue()},_setDynamicValue(e){this.setValue(e)},_editTags(){DTags.edit(DTags.getDynamicString(this._getDynamicValue()),e=>{this._setDynamicValue(`@tags()${e}@endtags()`),this.applySavedValue(),this.$el.find(".edit-voxel-tags .tags-content").html(DTags.formatAsHTML(e?.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")))})},_enableTags(){var e=DTags.getDynamicString(this._getDynamicValue());this._setDynamicValue(`@tags()${e}@endtags()`),this.applySavedValue(),this.$el.addClass("voxel-tags-active"),this.$el.find(".enable-tags").hide(),this.$el.find(".edit-voxel-tags .tags-content").html(DTags.formatAsHTML(e?.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"))),this.$el.find(".edit-voxel-tags").show()},_disableTags(){confirm("Are you sure?")&&(this.$el.removeClass("voxel-tags-active"),this.$el.find(".enable-tags").show(),this.$el.find(".edit-voxel-tags").hide(),this._setDynamicValue(""),this.applySavedValue())}}))):console.warn(`Control module for "${e}" does not exist.`)}),elementor.modules.controls.Color.prototype.applySavedValue=function(){var e,t=this.getCurrentValue();this.colorPicker?t?(e=this.colorPicker.picker._parseLocalColor(t),this.colorPicker.picker.setHSVA(...e.values||[],!1)):this.colorPicker.picker._clearColor(!0):this.initPicker(),this.$el.toggleClass("e-control-color--no-value",!t)},elementor.modules.controls.Url.prototype._getDynamicValue=function(){return this.getControlValue().url},elementor.modules.controls.Url.prototype._setDynamicValue=function(e){return this.setValue("url",e)},elementor.modules.controls.Media.prototype._getDynamicValue=function(){return this.getControlValue().id},elementor.modules.controls.Media.prototype._setDynamicValue=function(e){return this.setValue("url",e),this.setValue("id",e)},elementor.modules.controls.Gallery.prototype._getDynamicValue=function(){return this.getControlValue()[0]?.id||[]},elementor.modules.controls.Gallery.prototype._setDynamicValue=function(e){return this.setValue([{id:e,url:" "}])},elementor.modules.controls.Icons.prototype._getDynamicValue=function(){return this.getControlValue().value},elementor.modules.controls.Icons.prototype._setDynamicValue=function(e){return this.setValue({value:e,library:" "})},elementor.modules.controls.Icons.prototype.applySavedValue=function(){var e=this.getControlValue(),t=this.model.get("skin"),l="inline"===t?this.ui.inlineDisplayedIcon:this.ui.previewPlaceholder,a=this.model.get("disable_initial_active_state"),s=this.model.get("default");let i=e.value,o=e.library;return this.isMigrationAllowed()||i||!this.getValueToMigrate()||(i=this.getControlValue(),o=""),"media"===t&&this.ui.controlMedia.toggleClass("elementor-media-empty",!i),("inline"===t&&!a||o)&&this.markChecked(o),i?"svg"===o&&"inline"!==t?elementor.helpers.fetchInlineSvg(i.url,e=>{new RegExp("<html|<head|<body","im").test(e)||this.ui.previewPlaceholder.html(e)}):("media"!==t&&"svg"===o||(e='<i class="'+i+'"></i>',l.html(e)),void this.enqueueIconFonts(o)):"inline"===t?void this.setDefaultIconLibraryLabel(s,l):void this.ui.previewPlaceholder.html("")},elementor.modules.controls.Select2.prototype.handleLockedOptions=function(){const t=this.model.get("lockedOptions");t&&this.ui.select.on("select2:unselecting",e=>{t.includes(e.params.args.data.id)&&e.preventDefault()});var l=this.ui.select,a=l.next(".select2-container").first("ul.select2-selection__rendered");a.on("click touchstart",e=>{$(e.target).hasClass("select2-selection__choice__remove")&&e.stopImmediatePropagation()}),a.sortable({placeholder:"ui-state-highlight",forcePlaceholderSize:!0,items:"li:not(.select2-search__field)",tolerance:"pointer",containment:"parent"}),a.on("sortupdate",e=>{e.stopImmediatePropagation(),$(a.find(".select2-selection__choice").get().reverse()).each((e,t)=>{var t=$(t).find("._s2-value").data("value");t&&(t=l.find('option[value="'+t+'"]')[0],l.prepend(t))}),this.ui.select.trigger("change")}),a.on("sortstop",e=>e.stopImmediatePropagation())},elementor.modules.controls.Select2.prototype.getSelect2Options=function(){return $.extend(this.getSelect2DefaultOptions(),this.model.get("select2options"),{templateSelection:e=>$('<span class="_s2-value"></span>').data("value",e.id).text(e.text)})},window.voxel_handle_tags=l=>(Object.keys(l).forEach(e=>{var t;"string"==typeof l[e]&&DTags.isDynamicString(l[e])&&(t=DTags.getDynamicString(l[e]),l[e]=`<span class="dtags-elementor" dtags>${DTags.formatAsText(t)}</span>`)}),l),window.voxel_prepare_page_settings=()=>{function a(e){let l=[];return l.push(e.parent().find("> .elementor-element").index(e)),e.parents("[data-id]").each((e,t)=>{l.push(jQuery(t).parent().find("> .elementor-element").index(t))}),l.reverse().join(".")}let t=elementor.config.voxel.relations,l=(Object.keys(t).forEach(e=>{t[e].filter(e=>{var t=elementor.$previewContents.find(".elementor-element-"+e.left),l=elementor.$previewContents.find(".elementor-element-"+e.right);return!(!t.length||!l.length||(e.leftPath=a(t),e.rightPath=a(l),0))})}),{});return elementor.$previewContents.find(".elementor-widget-ts-template-tabs").each((e,t)=>{l[t.dataset.id]=a(jQuery(t))}),{relations:t,template_tabs:l}},window.voxel_reload_preview=()=>{elementorCommon.dialogsManager.createWidget("confirm",{headerMessage:"Apply Changes",message:"This will update the document with the current changes and reload the preview.",strings:{confirm:"Apply & Reload preview"},onConfirm:function(){$e.run("document/save/update").then(()=>{jQuery("#elementor-preview-loading").show(),setTimeout(()=>{$e.internal("editor/documents/attach-preview",{shouldScroll:!1}).then(()=>jQuery("#elementor-loading, #elementor-preview-loading").fadeOut(600))},15)})}}).show()},window.voxel_reload_editor=()=>{elementorCommon.dialogsManager.createWidget("confirm",{headerMessage:"Apply Changes",message:"This will update the document with the current changes and reload the page.",strings:{confirm:"Apply & Reload page"},onConfirm:function(){$e.run("document/save/update").then(()=>location.reload())}}).show()},elementor.hooks.addFilter("elements/widget/behaviors",e=>(e.InlineEditing.behaviorClass.prototype.onInlineEditingClick=function(e){var t=this,l=jQuery(e.currentTarget);l.find("[dtags]").length||setTimeout(function(){t.startEditing(l)},30)},e)),$e.components.get("document/save").on("save",e=>{function a(e){let l=[];return l.push(e.parent().find("> .elementor-element").index(e)),e.parents("[data-id]").each((e,t)=>{l.push(jQuery(t).parent().find("> .elementor-element").index(t))}),l.reverse().join(".")}let t=elementor.config.voxel.relations,l=(Object.keys(t).forEach(e=>{t[e].filter(e=>{var t=elementor.$previewContents.find(".elementor-element-"+e.left),l=elementor.$previewContents.find(".elementor-element-"+e.right);return!(!t.length||!l.length||(e.leftPath=a(t),e.rightPath=a(l),0))})}),{});elementor.$previewContents.find(".elementor-widget-ts-template-tabs").each((e,t)=>{l[t.dataset.id]=a(jQuery(t))}),elementorCommon.ajax.addRequestConstant("voxel",JSON.stringify(window.voxel_prepare_page_settings()))}),elementor.modules.elements.views.BaseElement.prototype.isStyleTransferControl=function(e){return!!e&&(void 0!==e.style_transfer?e.style_transfer:"content"!==e.tab||e.selectors||e.prefix_class)};{let t=Voxel_Elementor_Config;t&&t.is_preview_card&&(document.body.classList.add("vx-editing-preview-card"),elementor.once("preview:loaded",()=>{var e=elementor.$preview.contents();e.find("body").addClass("vx-viewport-card"),e.find(".elementor.elementor-"+t.header_id).hide(),e.find(".elementor.elementor-"+t.footer_id).hide(),e.find("#query-monitor-main, .grecaptcha-badge").hide()}))}});
